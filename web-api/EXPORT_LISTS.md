# Export Lists –¥–ª—è pfSense

## –û–ø–∏—Å–∞–Ω–∏–µ

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–ø–∏—Å–∫–æ–≤ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏ –¥–æ–º–µ–Ω–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ plain text –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –∞–ª–∏–∞—Å–æ–≤ pfSense.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –≠–∫—Å–ø–æ—Ä—Ç –¥–æ–º–µ–Ω–æ–≤ –∏ IP-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ HTTP –≤ —Ñ–æ—Ä–º–∞—Ç–µ plain text
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤—ã—Ä–∞–∂–µ–Ω–∏—é –¥–ª—è –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤ –≤ –≤—ã–≥—Ä—É–∑–∫–µ
- **–†–∞–∑–¥–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è IPv4 –∏ IPv6 –∞–¥—Ä–µ—Å–æ–≤**
- **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ shared IP –∞–¥—Ä–µ—Å–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥–æ–º–µ–Ω–∞–º–∏)**
- **–û—Ç–¥–µ–ª—å–Ω—ã–π endpoint –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã—Ö IP**
- **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö IP –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –¥–æ–º–µ–Ω—ã, IPv4, IPv6
- HTTP –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (5 –º–∏–Ω—É—Ç)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–ø–∏—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏ `export_lists` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:

```yaml
export_lists:
  - name: "Example Domain List"
    endpoint: "/export/example"
    domain_regex: "^example\\.com$"
    include_domains: true
  - name: "Google Services"
    endpoint: "/export/google"
    domain_regex: ".*\\.google\\.com$"
    include_domains: true
  - name: "All Domains IPs Only"
    endpoint: "/export/all-ips"
    domain_regex: ".*"
    include_domains: false
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- `name` - –ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `endpoint` - HTTP endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `/`)
- `domain_regex` - –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–æ–≤ (PostgreSQL regex —Å–∏–Ω—Ç–∞–∫—Å–∏—Å)
- `include_domains` - –§–ª–∞–≥ –≤–∫–ª—é—á–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–≤ –≤ –≤—ã–≥—Ä—É–∑–∫—É (true/false)

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–æ–≤—ã–µ –≤ v2.4.0)

- `include_ipv4` - –í–∫–ª—é—á–∏—Ç—å IPv4 –∞–¥—Ä–µ—Å–∞ –≤ —ç–∫—Å–ø–æ—Ä—Ç (default: `true`)
- `include_ipv6` - –í–∫–ª—é—á–∏—Ç—å IPv6 –∞–¥—Ä–µ—Å–∞ –≤ —ç–∫—Å–ø–æ—Ä—Ç (default: `true`)
- `exclude_shared_ips` - –ò—Å–∫–ª—é—á–∏—Ç—å IP –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –¥–æ–º–µ–Ω–∞–º–∏ –∏–∑ —Å–ø–∏—Å–∫–∞, —Ç–∞–∫ –∏ –¥–æ–º–µ–Ω–∞–º–∏ –≤–Ω–µ —Å–ø–∏—Å–∫–∞ (default: `false`)
- `excluded_ips_endpoint` - Endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã—Ö IP —Å –¥–µ—Ç–∞–ª—è–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `additional_ips_file` - –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ IP –∞–¥—Ä–µ—Å–∞–º–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —ç–∫—Å–ø–æ—Ä—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –î–ª–∏–Ω–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –±–æ–ª–µ–µ 200 —Å–∏–º–≤–æ–ª–æ–≤
- –ó–∞–ø—Ä–µ—â–µ–Ω—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã regex (–¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç ReDoS –∞—Ç–∞–∫)
- –ò–º–µ–Ω–∞ —Å–ø–∏—Å–∫–æ–≤ –∏ endpoints –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏
- –ü—É—Ç—å –∫ `additional_ips_file` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `/app/config/`
- –ú–∞–∫—Å–∏–º—É–º 100,000 —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö IP

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (v2.4.0)

### 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è IPv4/IPv6

–ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∫–∞–∫–∏–µ —Ç–∏–ø—ã IP –∞–¥—Ä–µ—Å–æ–≤ –≤–∫–ª—é—á–∞—Ç—å –≤ —ç–∫—Å–ø–æ—Ä—Ç. –ü–æ–ª–µ–∑–Ω–æ –∫–æ–≥–¥–∞:
- Firewall –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç IPv6
- –ù—É–∂–Ω—ã —Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è IPv4 –∏ IPv6 –ø—Ä–∞–≤–∏–ª
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Å–ø–∏—Å–∫–∞

**–ü—Ä–∏–º–µ—Ä**: –¢–æ–ª—å–∫–æ IPv4 –∞–¥—Ä–µ—Å–∞
```yaml
export_lists:
  - name: "IPv4 Only List"
    endpoint: "/export/ipv4-only"
    domain_regex: ".*"
    include_domains: true
    include_ipv4: true
    include_ipv6: false
```

### 2. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ Shared IP (exclude_shared_ips)

–ò—Å–∫–ª—é—á–∞–µ—Ç –∏–∑ —ç–∫—Å–ø–æ—Ä—Ç–∞ IP –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** –¥–æ–º–µ–Ω–∞–º–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –ò –¥–æ–º–µ–Ω–∞–º–∏ –≤–Ω–µ —Å–ø–∏—Å–∫–∞.

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ –∂–µ IP —á—Ç–æ –∏ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, CDN, –æ–±–ª–∞—á–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã).

**–ü—Ä–∏–º–µ—Ä**: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫–ª–∞–º—ã –±–µ–∑ –≤—Ä–µ–¥–∞ –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∞–π—Ç–∞–º
```yaml
export_lists:
  - name: "Ad Blocklist Safe"
    endpoint: "/export/ads"
    domain_regex: "^(ads|adservice|tracking)\\."
    include_domains: true
    exclude_shared_ips: true  # –ë–ª–æ–∫–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ IP —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
- DNS Collector –≤–∏–¥–∏—Ç: `ads.example.com` ‚Üí `192.0.2.1`
- DNS Collector –≤–∏–¥–∏—Ç: `www.example.com` ‚Üí `192.0.2.1`
- –° `exclude_shared_ips: false` ‚Üí `192.0.2.1` –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —ç–∫—Å–ø–æ—Ä—Ç
- –° `exclude_shared_ips: true` ‚Üí `192.0.2.1` **–∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è** (shared IP)

### 3. Endpoint –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã—Ö IP

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫–∏–µ IP –±—ã–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏ –ø–æ—á–µ–º—É.

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –ê—É–¥–∏—Ç –∏ –æ—Ç–ª–∞–¥–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –ê–Ω–∞–ª–∏–∑ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–º–µ–Ω–æ–≤

**–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞**:
```
# Excluded IPs (shared between matched and non-matched domains)
# Format: IP | Matched Domains | Non-Matched Domains
#
192.0.2.1 | ads.example.com, tracking.example.com | www.example.com, api.example.com
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**:
```yaml
export_lists:
  - name: "Ad Blocklist with Analysis"
    endpoint: "/export/ads"
    excluded_ips_endpoint: "/export/ads-excluded"  # Endpoint –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    domain_regex: "^(ads|tracking)\\."
    include_domains: true
    exclude_shared_ips: true
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
# –ü–æ–ª—É—á–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π blocklist
curl http://localhost:8080/export/ads > ads-blocklist.txt

# –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫–∏–µ IP –±—ã–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã
curl http://localhost:8080/export/ads-excluded
```

### 4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ IP (additional_ips_file)

–î–æ–±–∞–≤–ª—è–µ—Ç IP –∞–¥—Ä–µ—Å–∞ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞ –≤ —ç–∫—Å–ø–æ—Ä—Ç.

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö IP –∏–∑ threat intelligence feeds
- –†—É—á–Ω—ã–µ blacklist/whitelist
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ IP, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¥–æ–º–µ–Ω–∞–º–∏ –≤ –ë–î

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞** (`/app/config/additional-ips.txt`):
```
# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #
192.0.2.100
192.0.2.101

# Known malware C&C servers
203.0.113.50
203.0.113.51

# IPv6 addresses
2001:db8::100
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**:
```yaml
export_lists:
  - name: "Malware Blocklist Extended"
    endpoint: "/export/malware"
    domain_regex: "\\.(malware|virus|trojan)\\."
    include_domains: false
    additional_ips_file: "/app/config/known-malware-ips.txt"
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –§–∞–π–ª —á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ —ç–∫—Å–ø–æ—Ä—Ç–∞
- –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (`#`) –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ IP –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º –≤ –ª–æ–≥–∞—Ö
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `include_ipv4` –∏ `include_ipv6` –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å IP –∏–∑ –ë–î

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```bash
curl http://localhost:8080/export/example
```

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

```
example.com
203.0.113.5
198.51.100.1
2001:db8::1
```

### –ü–æ—Ä—è–¥–æ–∫ –¥–∞–Ω–Ω—ã—Ö –≤ –æ—Ç–≤–µ—Ç–µ

1. –î–æ–º–µ–Ω—ã (–µ—Å–ª–∏ `include_domains: true`)
2. IPv4 –∞–¥—Ä–µ—Å–∞
3. IPv6 –∞–¥—Ä–µ—Å–∞

–ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, –±–µ–∑ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –º–µ–∂–¥—É —Å–µ–∫—Ü–∏—è–º–∏.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å pfSense

1. –í pfSense –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Firewall > Aliases**
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∞–ª–∏–∞—Å —Ç–∏–ø–∞ "URL Table (IPs)" –∏–ª–∏ "URL Table"
3. –í –ø–æ–ª–µ URL —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä:
   ```
   http://dns-collector-api:8080/export/example
   ```
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (Update Frequency)
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π

### –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞
```yaml
domain_regex: "^example\\.com$"
```

### –í—Å–µ –ø–æ–¥–¥–æ–º–µ–Ω—ã
```yaml
domain_regex: ".*\\.example\\.com$"
```

### –î–æ–º–µ–Ω—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ–º
```yaml
domain_regex: ".*\\.ru$"
```

### –ù–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–º–µ–Ω–æ–≤ (OR)
```yaml
domain_regex: "^(example\\.com|test\\.org|demo\\.net)$"
```

### –í—Å–µ –¥–æ–º–µ–Ω—ã
```yaml
domain_regex: ".*"
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
- –ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–µ regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω –∏ endpoints
- Content-Type –æ—Ç–≤–µ—Ç–∞ –≤—Å–µ–≥–¥–∞ `text/plain; charset=utf-8`

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
Registered export list 'Example Domain List' at /export/example
```

–û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–µ—Ç–∞–ª–µ–π.

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
curl -I http://localhost:8080/export/example

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
curl http://localhost:8080/export/example | head -n 10
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫–ª–∞–º—ã (IPv4 only, –±–µ–∑–æ–ø–∞—Å–Ω–∞—è)

**–ó–∞–¥–∞—á–∞**: –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–ª–∞–º–Ω—ã–µ –¥–æ–º–µ–Ω—ã, –Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ shared IP.

```yaml
export_lists:
  - name: "Ad Blocklist IPv4"
    endpoint: "/export/ads-ipv4"
    excluded_ips_endpoint: "/export/ads-ipv4-excluded"
    domain_regex: "^(ads|adservice|adserver|doubleclick|googlesyndication)\\."
    include_domains: true
    include_ipv4: true
    include_ipv6: false  # Firewall –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç IPv6
    exclude_shared_ips: true  # –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º CDN –∏ –æ–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ pfSense Alias
curl http://dns-api:8080/export/ads-ipv4 > /var/db/aliastables/ads_blocklist.txt

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±—ã–ª–æ –∏—Å–∫–ª—é—á–µ–Ω–æ
curl http://dns-api:8080/export/ads-ipv4-excluded
```

### –ü—Ä–∏–º–µ—Ä 2: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π malware blocklist

**–ó–∞–¥–∞—á–∞**: –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –¥–æ–º–µ–Ω—ã + —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ IP –∏–∑ threat intel.

```yaml
export_lists:
  - name: "Malware Comprehensive"
    endpoint: "/export/malware-all"
    domain_regex: "\\.(malware|virus|trojan|botnet|ransomware|phish)\\."
    include_domains: false  # –¢–æ–ª—å–∫–æ IP, –¥–æ–º–µ–Ω—ã –Ω–µ –Ω—É–∂–Ω—ã
    include_ipv4: true
    include_ipv6: true
    exclude_shared_ips: true
    additional_ips_file: "/app/config/threat-intel-ips.txt"
```

**–§–∞–π–ª `/app/config/threat-intel-ips.txt`**:
```
# Threat Intelligence Feed - Updated 2025-12-24
# Source: Example Threat Intel Provider

# Known C&C servers
198.51.100.10
198.51.100.11
203.0.113.50

# Botnet infrastructure
192.0.2.100
192.0.2.101

# IPv6 malware
2001:db8:bad::1
2001:db8:bad::2
```

### –ü—Ä–∏–º–µ—Ä 3: –†–∞–∑–¥–µ–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è IPv4 –∏ IPv6

**–ó–∞–¥–∞—á–∞**: –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ pfSense aliases –¥–ª—è IPv4 –∏ IPv6.

```yaml
export_lists:
  # IPv4 —Å–ø–∏—Å–æ–∫
  - name: "Tracking IPv4"
    endpoint: "/export/tracking-v4"
    domain_regex: "^(tracking|analytics|telemetry)\\."
    include_domains: false
    include_ipv4: true
    include_ipv6: false

  # IPv6 —Å–ø–∏—Å–æ–∫
  - name: "Tracking IPv6"
    endpoint: "/export/tracking-v6"
    domain_regex: "^(tracking|analytics|telemetry)\\."
    include_domains: false
    include_ipv4: false
    include_ipv6: true
```

### –ü—Ä–∏–º–µ—Ä 4: –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å –∞–Ω–∞–ª–∏–∑–æ–º

**–ó–∞–¥–∞—á–∞**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≥–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∞—É–¥–∏—Ç–∞.

```yaml
export_lists:
  - name: "Corporate Blocklist"
    endpoint: "/export/corporate-block"
    excluded_ips_endpoint: "/export/corporate-block-excluded"
    domain_regex: "^(social-media|gaming|streaming|adult)\\."
    include_domains: true
    include_ipv4: true
    include_ipv6: true
    exclude_shared_ips: true
    additional_ips_file: "/app/config/corporate-manual-block.txt"
```

**Workflow**:
1. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å excluded endpoint –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
2. –ü—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ —Ç–æ–º, —Å—Ç–æ–∏—Ç –ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å shared IP
3. –î–æ–±–∞–≤–ª—è—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ IP –≤ `corporate-manual-block.txt`
4. pfSense –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç alias

### –ü—Ä–∏–º–µ—Ä 5: Legacy –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

**–ó–∞–¥–∞—á–∞**: –°—Ç–∞—Ä–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

```yaml
export_lists:
  - name: "Legacy List"
    endpoint: "/export/legacy"
    domain_regex: "^example\\."
    include_domains: true
    # –í—Å–µ –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è defaults:
    # include_ipv4: true (default)
    # include_ipv6: true (default)
    # exclude_shared_ips: false (default)
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ —ç–∫—Å–ø–æ—Ä—Ç–∞

**–ü—Ä–∏—á–∏–Ω—ã**:
1. Regex –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç –Ω–∏ —Å –æ–¥–Ω–∏–º –¥–æ–º–µ–Ω–æ–º –≤ –ë–î
2. –í—Å–µ IP –∞–¥—Ä–µ—Å–∞ –∏—Å–∫–ª—é—á–µ–Ω—ã (–µ—Å–ª–∏ `exclude_shared_ips: true`)
3. `include_ipv4: false` –∏ `include_ipv6: false` –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–∏–µ –¥–æ–º–µ–Ω—ã –≤ –ë–î
curl http://dns-api:8080/api/domains?limit=100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å excluded IP
curl http://dns-api:8080/export/your-list-excluded

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs web-api | grep "Export list returned empty"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∞–π–ª –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö IP –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã**:
1. –ü—É—Ç—å –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π
2. –§–∞–π–ª –Ω–µ –≤ `/app/config/`
3. –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec dns-collector-webapi ls -la /app/config/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
docker exec dns-collector-webapi cat /app/config/your-file.txt

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs web-api | grep "additional"
```

### –ü—Ä–æ–±–ª–µ–º–∞: Excluded endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫

**–ü—Ä–∏—á–∏–Ω—ã**:
1. `exclude_shared_ips: false` (–∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è)
2. –ù–µ—Ç IP, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ matched –∏ non-matched –¥–æ–º–µ–Ω–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ shared IP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Å–ø–æ—Ä—Ç
curl http://dns-api:8080/export/your-list

# –ï—Å–ª–∏ –≤ –Ω–µ–º –µ—Å—Ç—å IP, –Ω–æ excluded –ø—É—Å—Ç–æ–π - –∑–Ω–∞—á–∏—Ç –≤—Å–µ IP —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ
```

## Changelog

### v2.4.0 (2025-12-24)
- ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è IPv4/IPv6 (`include_ipv4`, `include_ipv6`)
- ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ shared IP (`exclude_shared_ips`)
- ‚ú® –î–æ–±–∞–≤–ª–µ–Ω endpoint –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã—Ö IP (`excluded_ips_endpoint`)
- ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö IP (`additional_ips_file`)
- üîí –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üìù –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏
